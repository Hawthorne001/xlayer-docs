# X Layer RPC Quick‑Start and Erigon Node Setup

This guide helps you connect to X Layer Mainnet/Testnet in under 5 minutes and, if needed, run your own production JSON‑RPC node powered by `xlayer-erigon`. For a general overview of X Layer RPC endpoints, please refer to the following supplementary [document](https://web3.okx.com/zh-hans/xlayer/docs/developer/rpc-endpoints/rpc-endpoints "document").

Because X Layer is EVM‑equivalent, it follows the Ethereum JSON‑RPC specification. Any tool that already works with Ethereum (MetaMask, Hardhat, Foundry, ethers.js, web3.js, curl) works out‑of‑the‑box once you point it at an X Layer RPC endpoint.

## What is an RPC endpoint and why you need one
A Remote Procedure Call (RPC) lets a client invoke functions on a remote server as if they were local. A blockchain node exposes such an interface so external programs (wallets, scripts, backends, etc.) can query chain data, submit transactions over HTTP/WebSocket, and evaluate state.

## Quick‑Start: Connect & Verify
If you only need to interact with X Layer, use the public endpoints below. To remove rate limits and gain full logs, run your own node (see “Run Your Own X Layer RPC Node”).

| Parameter | Mainnet | Testnet |
| --- | --- | --- |
| Chain-ID (dec / hex) | 196 / 0xC4 | 195 / 0xC3 |
| Currency symbol | OKB | OKB (test faucet) |
| Primary HTTP RPC | https://rpc.xlayer.tech | https://xlayerrpc.okx.com |
| Alternative HTTP | https://testrpc.xlayer.tech | https://xlayertestrpc.okx.com |
| Block Explorer | https://web3.okx.com/explorer/x-layer | https://web3.okx.com/explorer/x-layer-testnet |

### Apply settings based on your scenario

| Scenario | Typical Tools | Where to paste the values |
| --- | --- | --- |
| Wallet / dApp front‑end | MetaMask, Rabby, Rainbow, etc. | Settings -> Networks -> Add Network (paste, then click "Save/Add"; wallet auto-switches to X Layer) |
| Dev environment / toolkit | Hardhat, Foundry, Truffle, etc. | Project config file ('hardhat.config.js', 'foundry.toml', 'truffle-config.js', etc.), then restart your tests or scripts |
| Quick CLI / script | Curl, wget, Postman, shell scripts | Any terminal, good for a rapid health check |

### Wallet / dApp front-end example: MetaMask (Mainnet)
```json
{
  "networkName": "X Layer Mainnet",
  "rpcURL": "https://rpc.xlayer.tech",
  "chainID": 196,
  "currencySymbol": "OKB",
  "blockExplorer": "https://web3.okx.com/explorer/x-layer"
}
```
After pasting, hit Save. MetaMask will show the X Layer network badge and your OKB balance (if any).

### Dev environment / toolkit example: Hardhat
```js
require("dotenv").config();

module.exports = {
  networks: {
    xlayer: {
      url: "https://rpc.xlayer.tech",
      chainId: 196,
      accounts: [process.env.PRIVATE_KEY],
    },
  },
};
```

Foundry? Add this to foundry.toml:
```toml
[rpc_endpoints]
xlayer = "https://rpc.xlayer.tech"
```

### 10-Second CLI smoke test (optional but recommended)
```bash
curl -X POST \
  -H "Content-Type: application/json" \
  --data '{"jsonrpc":"2.0","method":"eth_blockNumber","params":[],"id":1}' \
  https://rpc.xlayer.tech
```
If you get a hex block number back, the endpoint is live. If timeouts occur, please double-check the URL or any other pertaining issues.

---

## Run Your Own X Layer RPC Node 
Running your own node removes the currently-imposed public rate-limit of 100 requests per second per IP address (exhibited on both mainnet and testnet), and lets you inspect full log/metrics.
Follow the below playbook to have a mainnet-ready JSon-RPC endpoint in about 15 minutes.

### 1. Should you self‑host?

| Self-host if you... | Stick to the public RPC if you... |
| --- | --- |
| - Push >50 RPS or long-running indexers<br>- Need deterministic uptime/compliance<br>- Require full logs & debug traces | - Just want to test or have a low-traffic dApp<br>- Don't want to manage infra<br>- Okay with shared-node logging |

### 2. If yes, what you need for the setup

| Resource | Minimum | Notes |
| --- | --- | --- |
| CPU | 8 vCPU |  |
| RAM | 64 GB |  |
| Disk | 500G SSD |  |
| Software | OS: Linux (Ubuntu 22.04+) | Refer to [Docker](https://docs.docker.com/) · [Docs](https://github.com/okx/Deploy) (updated from xlayer GitHub docs) |
| L1 Endpoint | L1 (Ethereum mainnet) RPC endpoint (Alchemy, Infura, self‑run geth) for L2 synchronization | Refer to [Docker](https://docs.docker.com/) · [Docs](https://github.com/okx/Deploy) |
| Genesis File | https://raw.githubusercontent.com/okx/Deploy/main/mainnet/genesis.json |  |
| Chain ID | 196 (0xC4) |  |
| Sequencer URL | https://rpc.xlayer.tech/ |  |
| Data Streamer | stream.xlayer.tech:8800 |  |

---

## Multi‑step install & initialization (UPDATED – ERIGON SETUP)
Reference: [Deploy/mainnet/setup-erigon-rpc.md at main · okx/Deploy](https://github.com/okx/Deploy/blob/main/mainnet/setup-erigon-rpc.md)

Setup production erigon

`cdk-erigon` is a fork of Erigon, optimized for syncing with the XLayer network.

Minimum System Requirements

- 16 GB RAM
- 8 core CPU
- 500 GB Storage (This will increase over time)

Start Erigon RPC Node

Preparation

> Important: Go 1.24+ is required to build.

### Build
```bash
# Pull source
git clone https://github.com/okx/xlayer-erigon.git
cd xlayer-erigon

# Optionally switch to the latest release tag from https://github.com/okx/xlayer-erigon/releases
# Example
# git checkout vX.Y.Z

# Build the cdk-erigon binary (output at build/bin/cdk-erigon)
make cdk-erigon

# Optional: build a Docker image
make build-docker
```

### Modify Config
Create a configuration file named `xlayerconfig-mainnet.yaml` in the repo root and paste the following content. Please update the following fields before starting the node:

1. `datadir` — specify your desired data directory path.
2. `zkevm.l1-rpc-url` — provide the correct L1 RPC URL. For production environments, you should request an official RPC endpoint from your organization.

```yaml
datadir: /data/xlayer-erigon            # <- change to your path
chain: xlayer-mainnet
http: true
private.api.addr: localhost:9091

zkevm.l2-chain-id: 196
zkevm.l2-sequencer-rpc-url: https://rpc.xlayer.tech
zkevm.l2-datastreamer-url: stream.xlayer.tech:8800
zkevm.l1-rpc-url: https://mainnet.infura.io/v3/<YOUR_KEY>   # <- change to your L1 RPC
zkevm.l1-chain-id: 1

zkevm.address-sequencer: "0xAF9d27ffe4d51eD54AC8eEc78f2785D7E11E5ab1"
zkevm.address-zkevm: "0x2B0ee28D4D51bC9aDde5E58E295873F61F4a0507"
zkevm.address-rollup: "0x5132A183E9F3CB7C848b0AAC5Ae0c4f0491B7aB2"
zkevm.address-ger-manager: "0x580bda1e7A0CFAe92Fa7F6c20A3794F169CE3CFb"

zkevm.l1-rollup-id: 3
zkevm.l1-first-block: 19218658
zkevm.l1-block-range: 2000
zkevm.l1-query-delay: 1000
zkevm.datastream-version: 3
zkevm.increment-tree-always: true

http.api: [eth, debug, net, trace, web3, erigon, zkevm]
http.addr: 0.0.0.0
http.port: 8545
```

> Security note: Binding `http.addr` to `0.0.0.0` exposes your RPC on all interfaces. In production, restrict access with a firewall/load balancer.

### Start Erigon Node By binary
```bash
./build/bin/cdk-erigon --config "./xlayerconfig-mainnet.yaml"
```
If you see the following content in your log, the startup is successful:
```
INFO Mapped network port                      proto=udp extport=30304 intport=30304 interface="UPNP IGDv1-IP1"
INFO [1/16 L1Syncer] L1 Blocks processed progress (amounts): 64000/3358713 (1%)
INFO [1/16 L1Syncer] L1 Blocks processed progress (amounts): 140000/3358713 (4%)
INFO [1/16 L1Syncer] L1 Blocks processed progress (amounts): 222000/3358713 (6%)
```

### 4) Health check your node
```bash
curl -s -X POST http://127.0.0.1:8545 \
  -H 'Content-Type: application/json' \
  --data '{"jsonrpc":"2.0","method":"eth_blockNumber","params":[],"id":1}'
```

### Tips & troubleshooting
- If `eth_blockNumber` times out: verify port binding, firewall rules, and that the process is running.
- Sync stalls: ensure your L1 RPC is reachable, has sufficient rate‑limit, and the `zkevm.*` addresses/IDs are exact.
- Disk usage grows with time; plan monitoring and pruning/retention as needed.
- To enable tracing/inspection from clients, keep `debug`/`trace` in `http.api`.

---

## Appendix: Using Testnet instead
Replace endpoints with Testnet values and set your wallet/dev tools to chain ID `195 (0xC3)`. Public Testnet HTTP RPC: `https://xlayerrpc.okx.com` (alt: `https://xlayertestrpc.okx.com`). Explorer: `https://web3.okx.com/explorer/x-layer-testnet`.

If you need a Testnet faucet for `OKB`, check the X Layer community channels for current faucet links.

---

If you encounter issues or need production guidance, please consult the latest `xlayer-erigon` releases and the `okx/Deploy` repository for up‑to‑date parameters.
