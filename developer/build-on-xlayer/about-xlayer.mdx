# X Layer overview

X Layer is a cutting-edge Ethereum layer 2 (L2) network built by OKX and Polygon using Polygon's CDK. It offers full compatibility with the Ethereum Virtual Machine (EVM), enabling developers to deploy existing Ethereum applications and develop new, innovative projects at a fraction of the cost compared to doing so on Ethereum. X Layer also enables users to use dapps at significantly lower gas fees and faster speed compared to Ethereum.

X Layer's underlying architecture is an EVM validium with Pessimistic Proof (PP) based cross‑chain finality. Transactions on X Layer are executed and validated by the EVM; ZK proofs are not used to secure intra‑L2 transactions. Instead, Polygon's PP system is only used when bridging/cross‑chain to provide verifiable finality on L1 or other domains. This differs from rollups (ZK or OP), and offers the following benefits:
- **Significantly lower fees**, since they don't consume expensive Ethereum gas, i.e., blockspace to store transaction data.
- **Significantly higher scalability**, since validium throughput is not bounded by the L1 data publication limit used by rollups.

For more detailed information, you can check out the X Layer architecture below.

## X Layer architecture
The major components of X Layer are:
- **Virtual Machine**: EVM‑equivalent
- **Mode**: Validium
- **Data Availability**: Data Availability Committee (DAC)
- **Consensus**: X Layer PoE contract (pessimistic)
- **Sequencer**: Trusted
- **Gas token**: OKB

![X Layer Architecture](./img/xlayer-architecture.jpg)

## Background
X Layer has migrated to the Pessimistic Proof (PP) mode introduced by Polygon. In PP mode, the L2 chain runs as an EVM validium (trusted sequencers, DAC for data availability), and PP is used only for cross‑chain settlement (e.g., withdrawals) to provide verifiable finality on L1.

## Architecture diagram and flow (PP mode)
Below follows the numbering in the diagram (coarse‑grained, simplified wording):

- 1.x User Tx path on L2
  - 1.1 User sends Tx → 1.2 Proxyd relays to Erigon RPCs
  - 1.3 RPCs route Tx to Pool Manager / other APIs
  - 1.4 Pool Manager pushes Tx to Sequencer pool；1.5 RPCs monitor receipts
  - 1.6 Sequencer writes Tx records to DB（Postgres）
- 2.x Sequencing, data and DS
  - 2.1 RPC gets Tx；2.2 Sequencer generates block
  - 2.3 Write chain data；2.5 Write DS data；2.6 DS Relay pushes DS；2.7 DS Relay writes DS DB；2.8 RPCs push DS
- 3.x/4.x Certificate & PP pipeline
  - 4.1 aggSender fetches blocks；4.2 Double‑check
  - 4.3 Send certificate to agglayer；4.4 agglayer submits PP to L1
- 5.x Contract event sync
  - 5.1 Bridge Service syncs L2 contract events
  - 5.2 Sync L1 contract events

Outcome: execution/finality happens quickly on L2; for cross‑chain actions, a certificate + PP is produced and verified on L1 to finalize withdrawals/messages.

This flow ensures fast execution on L2 while providing cryptographic settlement for cross‑chain operations without publishing full L2 data to L1.

## X Layer Validium & Pessimistic Proofs (PP)
X Layer is built with Polygon CDK, an advanced open‑source framework designed for the rapid deployment of EVM L2 blockchains on [Ethereum](https://ethereum.org/en/ "Ethereum").

X Layer adopts the validium mode and implements a dedicated committee of sequencers, delivering a high‑performance L2 scaling solution that maintains interoperability with other Polygon chains.

Since transaction data is not stored on the Ethereum mainnet, it is both executed and stored off‑chain, which massively enhances scalability. Validium reduces L1 gas storage costs, hence reducing transaction costs for users on L2, with a prominent enhancement in user privacy and user experience.

For cross‑chain operations (for example, withdrawals and bridge messages), X Layer leverages Polygon's Pessimistic Proof (PP). PP produces a succinct proof that the claimed state transition is valid with respect to L2, enabling secure settlement on L1 without publishing full L2 transaction data.

## Validium vs. Rollups
Validiums differ from rollups and sidechains because they only share a proof of validity when needed (e.g., via PP for cross‑chain), which confirms the results of the transactions with Ethereum, not the actual transaction data of the executed transactions.
Here is how it operates: a verifier smart contract is deployed on Ethereum, and validium submits proof of validity to this contract. These proofs are zero knowledge in nature and contain transaction outcomes but not the specific transaction data.

The verifier smart contract assesses the validity of the proof. If it is found to be invalid, any claim submitted by the validium bridge is rejected and not stored on Ethereum.

![ZKValidium vs. ZKRollup](./img/zkvalidium-vs-zkrollup.jpg)

## Consensus & finality
X Layer uses a PoE‑based consensus on L2. Transactions are executed by the EVM and finalized on L2 by the trusted sequencer set. Cross‑chain finality is provided by PP proofs submitted to the L1 bridge/aggregator contract. Two key processes are involved: **transaction batching on L2** and **cross‑chain proofing (PP) for settlement**. Participants include **sequencers** (batch producers) and **aggregators/relayers** that submit PP proofs when bridging.

**Sequencer**: it is responsible for proposing transaction batches to the network, essentially grouping transaction requests and adding them to the L2 consensus contract.

**Aggregator/Relayer**: it is responsible for reviewing the batched state when bridging and providing the necessary PP validity proofs to the L1 verifier.

![Consensus Contract Flow](./img/consensus-contract-flow.png)

## Data Availability
X Layer operates in validium mode, where it integrates a secure data availability layer managed by a DAC. Below are the functionalities of DAC:
- Verifies the availability of data associated with specific blockchain blocks
- Ensures data robustness and computational efficiency of X Layer

### Advantages of the DAC provided by Polygon CDK
The DAC primarily provides:
- Lower transaction fees: less computations leads to lower fees
- State privacy: maintaining a secure state change record to ensure data integrity

<Tip title="Note">Check out [Ethereum Foundation’s Data availibilty](https://ethereum.org/en/developers/docs/data-availability/ "Ethereum Foundation’s Data Availibilty") and [Polygon CDK’s Data availability](https://ethereum.org/en/developers/docs/data-availability/ "Polygon CDK’s Data Availability") for more info on DAC.</Tip>

## X Layer node
The X Layer node (based on `xlayer-erigon`) syncs with the L2 state. Trusted sequencers are responsible for managing L2 state and batching, while cross‑chain finality is handled by PP.

![Node Architecture](./img/zknode-architecture.png)

<Tip title="Note">For node internals and configuration, see the `xlayer-erigon` repository.</Tip>

## Pessimistic Proofs (PP) for cross‑chain
For bridging and cross‑domain settlement, X Layer integrates Polygon's Pessimistic Proofs. During a withdrawal or cross‑chain message, an aggregator produces a PP that attests to the L2 state at a given checkpoint. This proof is verified by the L1 bridge/verifier contract before funds/messages are released on L1. PP is not used for day‑to‑day L2 transaction execution.

## Tokenomics
There are two main actors on X Layer that earn OKB as reward and pay OKB token as Gas fee for transactions at the same time.
### Sequencers
- Each sequencer is required to pay a fee in OKB tokens to have the privilege of creating and suggesting batches.
- When a sequencer successfully proposes valid batches containing valid transactions, they are rewarded with the fees paid by transaction requestors or network users.

### Aggregators
- Aggregators/relayers observe bridge states and produce PP certificates for cross‑chain settlement.
- Aggregators interact with `agglayer` components to generate proofs; no ZK proof is required for normal L2 transactions.
- For each certificate committed and verified on L1, aggregators receive fees paid by the corresponding bridge flows.
- Aggregators compete to produce and submit certificates based on their strategy and latency.

## Transactions on X Layer
Before making any transactions on layer 2, users need to have some OKB token on X Layer to perform any layer 2 transaction. To get OKB on layer 2, users need to transfer some OKB from L1 to L2 through X Layer bridge.
1. Visit [Bridge user guide](/users/move-your-funds/bridge-funds-to-xlayer "Bridge user guide") for detailed steps to transfer OKB from L1 to layer 2.
2. Layer 2 transactions：
  - The user starts a transaction from their wallet (e.g., MetaMask) and sends it to a sequencer.
  - Once the sequencer commits to adding the transaction, it becomes finalized on layer 2.
  - At this point, the transaction is settled on layer 2, but its state has not yet propagated to L1. This state is known as the **trusted state**.
  - The sequencer transmits the batch data to a smart contract on L1, permitting any node to synchronize its state from L1 in a secure, trustless manner. This state is referred to as the **virtual state**.
  - The aggregator gathers pending transactions for verification and constructs a proof to attain finality on L1.
  - After the proof undergoes validation, the user’s transactions gain finality on L1, a crucial step for actions like withdrawals. This state is called the **verified state**.
  
To get a sense of the complete transaction life cycle on X Layer, we recommend you to take a look at the [Transactions and data flow](/developer/architecture/transactions-n-data-flow "Transactions and data flow") document.

<Tip title="Note">For more EVM and zkEVM related questions, you can visit [Polygon’s EVM Equivalence FAQ](https://wiki.polygon.technology/docs/zkevm/faq/zkevm-eth-faq/ "Polygon’s EVM Equivalence FAQ") and [General FAQ](https://wiki.polygon.technology/docs/zkevm/faq/zkevm-general-faq/ "General FAQ") for more info.</Tip>